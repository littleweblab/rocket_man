///////////
// LOGIN //
///////////
module.exports = function ( write, callback ) {
  return fab.queue( function( yes ) {
    return fab.queue( function( no ) {
      return write( function( write, head, body ) {
        var app = no;
        
        function trigger () { 
          return callback ? callback({ url : head.url.href, pathname : head.url.pathname }) : false;
        }//END TRIGGER
         
        if ( trigger() == true ) app = yes;
            
        return app( function read( data ) {
          if ( !arguments.length ) return write;
          write = write.apply( this, arguments );
          return read;            
        }, head, body );//END APP
      })();//END WRITE
   });//END QUEUE NO 
  });//END QUEUE YES
};//END LOGI