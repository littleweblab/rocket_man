/////////////
// NODE$FS //
/////////////
module.exports = function( write ) {
       var fs = require( "fs" );
      return fab.queue( function( path ) {
        return write( function( write, head, body ) {
          return fab.queue( function( rest ) {
            return path( fab.render( fab.concat( function read( path ) {
              fs.createReadStream( path )
                .on( "data", function( body ){ write = write( body ) })
                .on( "end", function(){ rest( write, head, body ) })
                .on( "error", function(){ rest(
                  write( "File not found: " + path, { status: 404 } ), head, body
                )});
                
              return fab.ignore;
            }, head, body ), head, body), head, body );
          });
        });
      });
}//END FS
